import{C as e,a as u}from"./api-XB51Jzmp.js";const g=document.getElementById("loginContainer"),N=document.getElementById("dashboard"),E=document.getElementById("loginForm"),f=document.getElementById("userId"),h=document.getElementById("password"),c=document.getElementById("loginError"),A=document.getElementById("logoutBtn"),i=document.getElementById("drawBtn"),I=document.getElementById("drawBox"),s=document.getElementById("drawNumber"),d=document.getElementById("winnersBody");let l=null;E.addEventListener("submit",t=>{t.preventDefault();const n=f.value,o=h.value;n===e.ADMIN_USERNAME&&o===e.ADMIN_PASSWORD?(g.style.display="none",N.classList.add("show"),T(),y(),c.classList.remove("show")):c.classList.add("show")});A.addEventListener("click",()=>{g.style.display="flex",N.classList.remove("show"),w(),E.reset(),c.classList.remove("show")});async function m(){try{const t=await u.getStats();t.success&&(document.getElementById("totalCount").textContent=t.total||0,document.getElementById("atmNorth").textContent=t.atmCounts["Benhur-F"]||0,document.getElementById("atmSouth").textContent=t.atmCounts["Dinesh-Kumar"]||0,document.getElementById("atmEast").textContent=t.atmCounts["Harish-KS"]||0,document.getElementById("atmWest").textContent=t.atmCounts["Sivakumar-Kotipatruni"]||0)}catch(t){console.error("Error fetching stats:",t)}}function T(){m(),l=setInterval(m,e.STATS_UPDATE_INTERVAL)}function w(){l&&clearInterval(l)}i.addEventListener("click",p);async function p(){i.disabled=!0,I.classList.add("spinning");let t=0;const n=e.DRAW_ANIMATION.SPIN_DURATION/e.DRAW_ANIMATION.SPIN_INTERVAL,o=setInterval(()=>{const r=Math.floor(Math.random()*(e.TICKET_MAX-e.TICKET_MIN+1))+e.TICKET_MIN;s.textContent=r,t++,t>=n&&clearInterval(o)},e.DRAW_ANIMATION.SPIN_INTERVAL);setTimeout(async()=>{I.classList.remove("spinning");const r=setInterval(()=>{const a=Math.floor(Math.random()*(e.TICKET_MAX-e.TICKET_MIN+1))+e.TICKET_MIN;s.textContent=a},e.DRAW_ANIMATION.SLOW_INTERVAL);setTimeout(async()=>{clearInterval(r);try{const a=await u.drawWinner();a.success?(s.textContent=a.winner.ticketNumber,M(),setTimeout(()=>{y(),m()},2e3)):(alert(a.message||"No eligible participants for the draw."),s.textContent="000")}catch(a){console.error("Error during draw:",a),alert("An error occurred during the draw. Please try again."),s.textContent="000"}finally{i.disabled=!1}},e.DRAW_ANIMATION.SLOWDOWN_DURATION)},e.DRAW_ANIMATION.SPIN_DURATION)}async function y(){try{const t=await u.getWinners();t.success&&t.winners.length>0?(d.innerHTML="",t.winners.reverse().forEach((n,o)=>{const r=document.createElement("tr");r.innerHTML=`
          <td><span class="winner-badge">#${t.winners.length-o}</span></td>
          <td><strong>${n.ticketNumber}</strong></td>
          <td>${n.employeeId}</td>
          <td>${n.employeeName}</td>
          <td>${n.atmLocation}</td>
          <td>${C(n.drawDate)}</td>
        `,d.appendChild(r)})):d.innerHTML='<tr><td colspan="6" class="no-winners">No winners yet. Start the first draw!</td></tr>'}catch(t){console.error("Error loading winners:",t)}}function C(t){return new Date(t).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function M(){const t=["#f5576c","#f093fb","#ffd89b","#19547b","#51cf66","#4dabf7"];for(let n=0;n<100;n++)setTimeout(()=>{const o=document.createElement("div");o.className="confetti",o.style.left=Math.random()*100+"%",o.style.background=t[Math.floor(Math.random()*t.length)],o.style.transform=`rotate(${Math.random()*360}deg)`,document.body.appendChild(o),setTimeout(()=>{o.remove()},3e3)},n*30)}
